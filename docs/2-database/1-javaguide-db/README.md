---
# 这是页面的图标
icon: page

# 这是文章的标题
title: JavaGuide - 数据库基础知识

# 设置作者
author: lllllan

# 设置写作时间
# time: 2020-01-20

# 一个页面只能有一个分类
category: 数据库

# 一个页面可以有多个标签
tag:

# 此页面会在文章列表置顶
# sticky: true

# 此页面会出现在首页的文章板块中
star: true

# 你可以自定义页脚
# footer: 
---



::: warning 重要声明

转载自 [数据库基础知识 | JavaGuide](https://javaguide.cn/database/数据库基础知识/)，略有改动

:::

 

## 一、数据库、数据库管理系统、数据库系统、数据库管理员

- **数据库** : 数据库(DataBase 简称 DB)就是信息的集合或者说数据库是由数据库管理系统管理的数据的集合
- **数据库管理系统** : 数据库管理系统(Database Management System 简称 DBMS)是一种操纵和管理数据库的大型软件，通常用于建立、使用和维护数据库。
- **数据库系统** : 数据库系统(Data Base System，简称 DBS)通常由软件、数据库和数据管理员(DBA)组成。
- **数据库管理员** : 数据库管理员(Database Administrator, 简称 DBA)负责全面管理和控制数据库系统。



数据库系统基本构成：

![数据库系统基本构成](README.assets/e21120184e63406526a4e873cacd23f2.png)



## 二、元组、码、候选码、主码、外码、主属性、非主属性



- **元组** ： 元组（tuple）是关系数据库中的基本概念，关系是一张表，表中的 ==每行（即数据库中的每条记录）就是一个元组== ，每列就是一个属性。 在二维表里，元组也称为行。
- **码** ：码就是能 ==唯一标识实体的属性== ，对应表中的列。
- **候选码** ： 若关系中的 ==某一属性或属性组的值能唯一的标识一个元组== ，而其任何、子集都不能再标识，则称该属性组为候选码。例如：在学生实体中，“学号”是能唯一的区分学生实体的，同时又假设“姓名”、“班级”的属性组合足以区分学生实体，那么{学号}和{姓名，班级}都是候选码。
- **主码** : 主码也叫主键。主码是从候选码中选出来的。 一个实体集中只能有一个主码，但可以有多个候选码。
- **外码** : 外码也叫外键。如果一个关系中的一个属性是另外一个关系中的主码则这个属性为外码。
- **主属性** ： 候选码中出现过的属性称为主属性。比如关系 工人（工号，身份证号，姓名，性别，部门）. 显然工号和身份证号都能够唯一标示这个关系，所以都是候选码。工号、身份证号这两个属性就是主属性。如果主码是一个属性组，那么属性组中的属性都是主属性。
- **非主属性：** 不包含在任何一个候选码中的属性称为非主属性。比如在关系——学生（学号，姓名，年龄，性别，班级）中，主码是“学号”，那么其他的“姓名”、“年龄”、“性别”、“班级”就都可以称为非主属性



## 三、主键和外键

- **主键(主码)** ：主键用于唯一标识一个元组， ==不能有重复，不允许为空。一个表只能有一个主键。==

- **外键(外码)** ：外键用来和其他表建立联系用，外键是另一表的主键，外键是可以有重复的，可以是空值。一个表可以有多个外键。

    



## 四、不推荐使用外键和级联 ⭐

> 【强制】不得使用外键与级联，一切外键概念必须在应用层解决。
>
> 说明: 以学生和成绩的关系为例，学生表中的 student_id 是主键，那么成绩表中的 student_id 则为外键。如果更新学生表中的 student_id，同时触发成绩表中的 student_id 更新，即为 ==级联更新==。外键与级联更新 ==适用于单机低并发，不适合分布式、高并发集群; 级联更新是强阻塞，存在数据库更新风暴的风 险; 外键影响数据库的插入速度==
>
> ----- 阿里巴巴开发手册

外键的好处：

1. 保证了数据库数据的一致性和完整性
2. 级联操作方便、减轻了程序代码量
3. ...



外键的坏处：

1. 增加了复杂性：
    1. 每次更新和删除操作都要考虑外键约束，开发痛苦、测试不方便
    2. 需求的改变可能会增加麻烦
2. 增加了额外工作：增删改之后需要检查，保证数据的一致性和正确性，需要消耗资源。
3. 可能会因为需要请求对其他表内部加锁而容易出现死锁
4. 对分库分表不友好：分库分表下外键无法生效



## 五、ER图

**E-R 图** 也称实体-联系图(Entity Relationship Diagram)，提供了表示实体类型、属性和联系的方法，用来描述现实世界的概念模型。 它是描述现实世界关系概念模型的有效方法。 是表示概念关系模型的一种方式

![ER图示例](README.assets/4717673e36966e0e4b33fccfd753f6ea.png)

![关系模型](README.assets/5897753dfb301dfa3a814ab06e718a5e.png)



## 六、数据库范式



### 6.1 第一范式 1NF

数据库中每一列都是不可分割的基本数据项，同一列中不能有多个值，即实体中的某个属性不能有多个值或者不能有重复的属性。

第一范式是对关系模式的基本要求。



### 6.2 第二范式 2NF

在第一范式的基础上，消除了非主属性对于码的部分函数依赖。满足每个表中必须有主关键字，其他数据元素与主关键字一一对应。

![第二范式](README.assets/bd1d31be3779342427fc9e462bf7f05c.png)

- **函数依赖：** 若在一张表中，在属性X指确定的情况下，必定能确定属性Y的是值，那么就可以说Y函数依赖于X，写作`x -> Y`
- **部分函数依赖：** 如果 `X -> Y`，并且存在X的一个真子集 X0，使得 `X0 -> Y`，则称Y对X部分函数依赖。比如学生基本信息表 R 中（学号，身份证号，姓名）当然学号属性取值是唯一的，在 R 关系中，（学号，身份证号）->（姓名），（学号）->（姓名），（身份证号）->（姓名）；所以姓名部分函数依赖与（学号，身份证号）；
- **完全函数依赖：** 在一个关系中，若某个非主属性数据项依赖于全部关键字称之为完全函数依赖。比如学生基本信息表 R（学号，班级，姓名）假设不同的班级学号有相同的，班级内学号不能相同，在 R 关系中，（学号，班级）->（姓名），但是（学号）->(姓名)不成立，（班级）->(姓名)不成立，所以姓名完全函数依赖与（学号，班级）；
- **传递函数依赖：** 在关系模式 R(U) 中，设X、Y、Z是U的不同的属性子集，如果X确定Y，Y确定Z，且有X不包含Y，Y不确定X，`(X v Y) ^ Z = 空`，则称Z传递函数依赖于X。传递函数依赖会导致数据冗余和异常。比如在关系 R(学号 , 姓名, 系名，系主任)中，学号 → 系名，系名 → 系主任，所以存在非主属性系主任对于学号的传递函数依赖



### 6.3 第三范式 3NF

在第二范式基础上，消除了非主属性对码的传递函数依赖。满足表中的所有数据元素不但要能唯一地被关键字所表示，而且他们之间还必须相互独立、不存在其他函数关系。



### 总结

1. 第一范式：属性不可再分
2. 第二范式：第一范式基础上，消除了非主属性对于码的部分函数依赖
3. 第三范式，第二范式基础上，消除了非主属性对于码的传递函数依赖



## 七、存储过程

存储过程（Stored Procedure）是在大型[数据库系统](https://baike.baidu.com/item/数据库系统/215176)中，一组为了完成特定功能的SQL 语句集，它存储在数据库中，一次[编译](https://baike.baidu.com/item/编译/1258343)后永久有效，用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。

> 【强制】禁止使用存储过程，存储过程难以调试和扩展，更没有一致性。
>
> —— 阿里巴巴开发手册