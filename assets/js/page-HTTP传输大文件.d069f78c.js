(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1009:function(e,a,s){"use strict";s.r(a);var t=s(1),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("转载声明")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://juejin.cn/post/7005347768491311134",target:"_blank",rel:"noopener noreferrer"}},[e._v("HTTP 传输大文件有哪些方案？ - 掘金 (juejin.cn)"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/song_hai_lei/article/details/120976608",target:"_blank",rel:"noopener noreferrer"}},[e._v("HTTP传输大文件的方法_宋同学shl的博客-CSDN博客_传大文件"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/fanyun_01/article/details/80211799",target:"_blank",rel:"noopener noreferrer"}},[e._v("深入解析数据压缩算法_Geek.Fan的博客-CSDN博客_数据压缩算法"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://www.jianshu.com/p/9c1889be3d14",target:"_blank",rel:"noopener noreferrer"}},[e._v("HTTP CHUNK分块传输 - 简书 (jianshu.com)"),t("OutboundLink")],1)])])]),e._v(" "),t("p",[e._v("如标题所见，http在面临传输大文件的时候，也就是如何在有限带宽下高效快捷地传输这些大文件。")]),e._v(" "),t("h2",{attrs:{id:"数据压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据压缩"}},[e._v("#")]),e._v(" 数据压缩")]),e._v(" "),t("blockquote",[t("p",[e._v("是指在不丢失信息的前提下，缩减数据量以减少存储空间，提高传输、存储和处理效率的一种技术方法。或者是按照一定的算法对数据进行重新组织，减少数据的冗余和存储的空间。")]),e._v(" "),t("p",[e._v("更多介绍："),t("a",{attrs:{href:"https://blog.csdn.net/fanyun_01/article/details/80211799",target:"_blank",rel:"noopener noreferrer"}},[e._v("深入解析数据压缩算法_Geek.Fan的博客-CSDN博客_数据压缩算法"),t("OutboundLink")],1)])]),e._v(" "),t("p",[e._v("通常浏览器在发送请求时都会带着 "),t("code",[e._v("Accept-Encoding")]),e._v(" 头字段，里面是浏览器支持的压缩格式列表，例如  gzip、deflate、br 等，这样服务器就可以从中选择一种压缩算法，放进 "),t("code",[e._v("Content-Encoding")]),e._v(" 响应头里，再把原数据压缩后发给浏览器。")]),e._v(" "),t("CodeGroup",[t("CodeGroupItem",{attrs:{title:"客户端请求"}},[t("div",{staticClass:"language-http line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-http"}},[t("code",[t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("accept")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("*/*")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("accept-encoding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("gzip, deflate, br")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("accept-language")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("zh-CN,zh;q=0.9")])]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])])]),e._v(" "),t("CodeGroupItem",{attrs:{title:"服务器响应"}},[t("div",{staticClass:"language-http line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-http"}},[t("code",[t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("cache-control")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("max-age=2592000")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("content-encoding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("gzip")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("content-type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("application/x-javascript")])]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])])])],1),e._v(" "),t("h2",{attrs:{id:"分块传输"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分块传输"}},[e._v("#")]),e._v(" 分块传输")]),e._v(" "),t("blockquote",[t("p",[e._v("分块传输编码（Chunked transfer encoding）是超文本传输协议（HTTP）中的一种数据传输机制，允许HTTP由应用服务器发送给客户端应用（ 通常是网页浏览器）的数据可以分成多个部分。分块传输编码只在HTTP协议1.1版本（HTTP/1.1）中提供。")]),e._v(" "),t("p",[e._v("通常，持久链接需要服务器在开始发送消息体前发送Content-Length消息头字段，但是对于动态生成的内容来说，在内容创建完之前是不可知的。")]),e._v(" "),t("p",[e._v("使用分块传输能很好的应对这种问题，分块传输编码允许服务器在最后发送消息头字段。")])]),e._v(" "),t("p",[e._v("响应头 "),t("code",[e._v("Transfer-Encoding")]),e._v(" 字段的值为 "),t("code",[e._v("chunked")]),e._v("，表示数据以一系列分块的形式进行发送。需要注意的是 "),t("code",[e._v("Transfer-Encoding")]),e._v(" 和 "),t("code",[e._v("Content-Length")]),e._v(" 这两个字段是互斥的，也就是说响应报文中这两个字段不能同时出现")]),e._v(" "),t("p",[e._v("分块传输的编码规则：")]),e._v(" "),t("ul",[t("li",[e._v("每个分块包含分块长度和数据块两个部分；")]),e._v(" "),t("li",[e._v("分块长度使用 16 进制数字表示，以 "),t("code",[e._v("\\r\\n")]),e._v(" 结尾；")]),e._v(" "),t("li",[e._v("数据块紧跟在分块长度后面，也使用 "),t("code",[e._v("\\r\\n")]),e._v(" 结尾，但数据不包含 "),t("code",[e._v("\\r\\n")]),e._v("；")]),e._v(" "),t("li",[e._v("终止块是一个常规的分块，表示块的结束。不同之处在于其长度为 0，即 "),t("code",[e._v("0\\r\\n\\r\\n")])])]),e._v(" "),t("div",{staticClass:"language-http line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-http"}},[t("code",[t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Transfer-Encoding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("chunked")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Transfer-Encoding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("gzip, chunked")])]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[t("img",{attrs:{src:s(486),alt:"img",loading:"lazy"}})]),e._v(" "),t("h2",{attrs:{id:"范围请求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#范围请求"}},[e._v("#")]),e._v(" 范围请求")]),e._v(" "),t("blockquote",[t("p",[e._v("Range 头是在 HTTP/1.1 协议中新增的一个请求头。包含 Range 头的请求通常称为范围请求，因为 Range 头允许服务器只发送部分响应到客户端。范围请求可以满足以下一些场景：")]),e._v(" "),t("ul",[t("li",[e._v("断网重连之后，可以从下载中断处恢复下载")]),e._v(" "),t("li",[e._v("将大文件拆分后多线程下载")]),e._v(" "),t("li",[e._v("大文件中只想获取其中的一部分")])])]),e._v(" "),t("p",[e._v("如果在响应中存在 "),t("code",[e._v("Accept-Ranges")]),e._v(" 首部（并且它的值不为 “none”），那么表示该服务器支持范围请求。")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("unit")]),e._v("：范围请求所采用的单位，通常是字节（bytes）。")]),e._v(" "),t("li",[t("code",[e._v("<range-start>")]),e._v("：一个整数，表示在特定单位下，范围的起始值。")]),e._v(" "),t("li",[t("code",[e._v("<range-end>")]),e._v("：一个整数，表示在特定单位下，范围的结束值。"),t("strong",[e._v("这个值是可选的，如果不存在，表示此范围一直延伸到文档结束。")])])]),e._v(" "),t("CodeGroup",[t("CodeGroupItem",{attrs:{title:"单一范围"}},[t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('curl http://i.imgur.com/z4d4kWk.jpg -i -H "Range: bytes=0-1023"\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("CodeGroupItem",{attrs:{title:"多重范围"}},[t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('curl http://www.example.com -i -H "Range: bytes=0-50, 100-150"\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])])],1),e._v(" "),t("CodeGroup",[t("CodeGroupItem",{attrs:{title:"客户端请求"}},[t("div",{staticClass:"language-http line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-http"}},[t("code",[t("span",{pre:!0,attrs:{class:"token request-line"}},[t("span",{pre:!0,attrs:{class:"token method property"}},[e._v("GET")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token request-target url"}},[e._v("/big-file.txt")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token http-version property"}},[e._v("HTTP/1.1")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Host")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("localhost:3000")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Connection")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("keep-alive")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Referer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("http://localhost:3000/index.html")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Accept-Encoding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("identity")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Accept-Language")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("zh-CN,zh;q=0.9,en;q=0.8,id;q=0.7")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Range")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("bytes=0-100")])]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])])]),e._v(" "),t("CodeGroupItem",{attrs:{title:"服务器响应"}},[t("div",{staticClass:"language-http line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-http"}},[t("code",[t("span",{pre:!0,attrs:{class:"token response-status"}},[t("span",{pre:!0,attrs:{class:"token http-version property"}},[e._v("HTTP/1.1")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token status-code number"}},[e._v("206")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token reason-phrase string"}},[e._v("Partial Content")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Vary")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("Origin")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Accept-Ranges")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("bytes")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Last-Modified")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("Sun, 06 Jun 2021 01:40:19 GMT")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Cache-Control")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("max-age=0")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Content-Type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("text/plain; charset=utf-8")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Date")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("Sun, 06 Jun 2021 03:01:01 GMT")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Connection")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("keep-alive")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Content-Range")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("bytes 0-100/5243")])]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token header"}},[t("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Content-Length")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token header-value"}},[e._v("101")])]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br")])])])],1)],1)}),[],!1,null,null,null);a.default=n.exports},486:function(e,a,s){e.exports=s.p+"assets/img/block.86eac7e0.png"}}]);